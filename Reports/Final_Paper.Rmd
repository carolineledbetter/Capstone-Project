---
title: Association of Food Insecurity and Metabolic Syndrome among NHANES Participants 1999-2014
author: 
- Caroline Ledbetter, Anna Baron, PhD, Dana Dabalea, PhD
date: "Colorado School of Public Health"
  
  
header-includes:
- \usepackage{lscape}
- \newcommand{\blandscape}{\begin{landscape}}
- \newcommand{\elandscape}{\end{landscape}}

output: 
  pdf_document:
    fig_caption: yes
    fig_height: 3.5
    fig_width: 8
    latex_engine: xelatex

bibliography: /Users/Caroline/Repositories/Capstone-Project/Docs/paper.bib
csl: /Users/Caroline/Repositories/Capstone-Project/Docs/journal-of-nutrition.csl
---

```{r global_options, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
```


```{r setup, include=FALSE}
load(file = "~/Repositories/Data/Capstone/finaldescriptives.rdata")
load(file = '~/Repositories/Data/Capstone/analysis_report.rdata')
library(pander)
library(ggplot2)
library(grid)
library(gridExtra)
t <- 0 #index for tables
f <- 0 #index for figures
# increment function for tables/figs (this saves you from having to make sure which table 
# you are on if you reference in text)
inc <- function(x)
{
  eval.parent(substitute(x <- x + 1))
  return(x)
}
```

# Abstract  

# Introduction  
In the early 1980's there began to be a recognition in the United States that many households faced limited or uncertain access to adequate food differing from malnutrition and chronic hunger. Therefore, in 1995 the 18 item U.S. Food Security Survey Module was added to the Current Population Survey (CPS) to measure the prevalence of food insecurity in the US [@Carlson]. The USDA defines food insecurity as "limited or uncertain availability of nutritionally adequate and safe foods or uncertain ability to acquire acceptable foods in socially acceptable ways"[@Bickel]. In 2011, it was estimated that 14.9 percent of households were food insecure at least some of the year and that the typical food secure household spent 24 percent more on food than the typical food-insecure household of the same size and composition[@Coleman]. Households reporting food insecurity may be more likely to consume low-nutrient energy dense foods [@Drewnowski] and report a decrease in the frequency of consumption of fruits and vegetables[@Kendall]. Previous research has found an association between food insecurity and hyperglycemia, hypertension, diabetes[@Seligman; @Gucciardi], peripheral arterial disease [@Redmond], poor cardiovascular health [@Saiz], increased in BMI in young women[@Gooding], and poor health outcomes in disabled adults[@Brucker]. Berkowitz et al. also found an association between food insecurity and poor metabolic control in adults with diabetes[@Berkowitz]. 

Metabolic syndrome is the presence of multiple interrelated risk factors for cardiovascular disease (CVD) and diabetes. Metabolic syndrome is associated with a two-fold increased risk for developing CVD and a five-fold increase in type 2 diabetes mellitus. [@Alberti] According to the CDC, in 2014 heart disease was the leading cause of death and diabetes was the 7th leading cause of death[@CDCdeath].  A better understanding of the association between food security and poor cardiovascular and metabolic health can improve the effectiveness of public health interventions. To date, no studies have explored the association between food security and early indicators of poor cardiometabolic health other than BMI, but evidence suggests BMI may be a poor indicator[@Tomiyama].

# Methods  
*Data*  
This study used publicly available de-identified data from the CDC collected as part of the National Health and Nutrition Examination Study (NHANES), a cross-sectional, annual survey representative of the non-institutionalized US population[@NHANES]. The survey is conducted annually using a complex survey design and data are bundled into two-year cycles. Data was combined from eight NHANES cycles (1999 - 2014).  Only individuals who were selected for the morning examination are included as fasting glucose and triglyceride samples were only collected in those sessions. Individuals under 18 and over 65 were excluded as were pregnant women. Participants with missing exposure, outcome, and covariate data were also excluded from analysis.

Food insecurity was measured by the Adult Food Security Category. This information was captured during the Food Security Questionnaire. NHANES used the 12-month scale of the US Household Food Security Survey Module (FSSM), which consists of 18 items and has a three-stage design[@NHANES]. The screening design keeps respondent burden to a minimum as most households are asked only three questions (five in households with children). The USDA evaluated the reliability of the questionnaire using both traditional methods such as Spearman-Brown, Rulon’s and Cronbach’s alpha and novel methods to account for the high proportion of respondents that answer all questions in the negative[@Hamilton]. All measures gave values greater than .69 indicating good reliability. Responses are scored into four categories. In 2006, the food security category names were changed but the criteria did not [@Eisenmann; @NHANES]. '`r levels(analysis$FoodSecurity)[1]`' was defined as no to all items, '`r levels(analysis$FoodSecurity)[2]`' as yes to 2 or less items, '`r levels(analysis$FoodSecurity)[3]`' as yes to three to five items and '`r levels(analysis$FoodSecurity)[4]`' as yes to six to ten items. (Only 10 items are used in the scoring of adult food security, the remaining eight are used for child food security.) Responses to individual questions was not provided for confidentiality reasons. Food insecurity was defined as those individuals whose reported food security was 'full food security' or 'marginal food security' following guidance by the USDA[@Bickel].(Table `r inc(t)`)

``` {r food security definitions}
# Create table with food security definitions
tbl <- matrix(c("0", "1-2", '3-5', '6-10', levels(analysis$FoodSecurity), 'Food Secure', '" "', 
                'Food Insecure', '" "'), ncol = 3)
rownames(tbl) <- NULL
colnames(tbl) <- c('Number of Yes Responses', 'Food Security Categoty', 'Food Security Status')

panderOptions('table.split.table', Inf)
set.alignment('center')
pander(tbl, caption = 'Food Security Categories and Status')
```

Metabolic syndrome was defined using the harmonization criteria proposed in the joint interim statement of the International Diabetes Federation Task Force on Epidemiology and Prevention; National Heart, Lung, and Blood Institute; American Heart Association; World Heart Federation; International Atherosclerosis Society; and International Association for the Study of Obesity[@Alberti]. Individuals who met three or more of the following criteria were deemed to have metabolic syndrome: 1) waist circumference: $\geq$ 102 cm for men and $\geq$ 88 cm for women 2) blood pressure: average systolic $\geq$ 130 mm Hg or average diastolic $\geq$ 85 mm Hg or reported taking a prescribed drug to lower blood pressure 3) triglycerides: $\geq$ 150 mg/dL or reported taking a prescribed drug to lower cholesterol 4) HDL: $\geq$ 40 mg/dL men and $\geq$ 50 mg/dL women 5)fasting glucose: $\geq$ 100mg/dL or reported taking a prescribed drug to lower blood sugar (Table `r inc(t)`).

```{r met synd criteria}
# Create table with metabolic syndrome criteria
crit <- matrix(c('\\(\\geq\\) 102 cm for men and \\(\\geq\\) 88 cm for women',
          'average systolic \\(\\geq\\) 130 mm Hg or average diastolic \\(\\geq\\) 
          85 mm Hg or reported taking a prescribed drug to lower blood pressure',
          '\\(\\geq\\) 150 mg/dL or reported taking a prescirbed drug to lower cholesterol',
          '< 40 mg/dL men and < 50 mg/dL women',
          ' \\(\\geq\\) 100mg/dL or reported taking a prescribed drug to lower blood sugar'), 
          ncol =1)
rownames(crit) <- c('Waist Circumference', 'Blood Pressure', 'Triglycerides', 'HDL', 'Fasting Glucose')
colnames(crit) <- 'Criteria'
panderOptions('table.split.table', Inf)
set.alignment('left', row.names = 'left' )
pander(crit, 
       caption = 'Individuals with 3 or more criteria were classified as having metabolic syndrome')

```

Covariates known to be associated with metabolic syndrome and/or food security were included. Included covariates were age, gender, race/ethnicity, education, income, physical activity and smoking status. In 2011, NHANES started collecting data for Asians, however to preserve continuity the old race/ethnicity variable was used for all years. Annual family income was used, some participants answered "over $20,000" in lieu of the finer income categories, these responses were excluded as it was felt this category was to coarse. Moderate physical activity was determined as a yes to any question about performing more than 30 min of moderate activity on a typical day, as part of work, or in the last 30 days. In order to look at differences in prevalence of metabolic syndrome and food insecurity by age and NHANES cycle, age was categorized for those analyses only. Age categories were 20-29, 30-39, 40-49, and 50-59. 

*Analysis*  
All analysis was performed using the survey package v(`r packageVersion('lmerTest')`) [@survey] in `r R.Version()$version.string` [@R]. The complex survey design was incorporated in all estimations. All participants with a non-zero fasting sub-sample MEC weight were included in the design object and those participants meeting inclusion/exclusion criteria were indicated by a subset variable. 16-yr sub-sample weights were calculated according to the formula recommended by NHANES. [@NHANEStutor] Relative risk regression (binomial generalized linear regression with a log link function) was used to obtain all relative risks. Gender, age, and race/ethnciity were all evaluated for effect modification. The association between food insecurity and metabolic syndrome was evaluated both at the dichotimous food secure/food insecure level and for each categorical food security level (marginal, low, very low) using full food security as the reference group. All covariates that were not found to be effect modifiers were adjusted for. Significance of interaction terms for effect modification was determined using partial-F tests. P-values less than 0.05 were considered significant. 


``` {r create n vars}
# this creates variables for the various numbers used in the text and the flow chart
n_tot <- format(nrow(analysis), big.mark = ',', trim = T)
n_incl_age <- format(nrow(analysis) - nrow(analysis[analysis$exclreason %in% 'Age',]), 
                     big.mark = ',', trim = T)
n_excl_preg <- format(nrow(analysis[analysis$exclreason %in%  'Pregnancy',]), 
                      big.mark = ',', trim = T)
n_excl_outcome <- format(nrow(analysis[analysis$exclreason %in%  'Outcome',]), 
                         big.mark = ',', trim = T)
n_excl_exp <- format(nrow(analysis[is.na(analysis$foodinsecure) & 
                                     analysis$subset == T,]), big.mark = ',', trim = T)
n_excl_covariates <- format(nrow(analysis[!is.na(analysis$foodinsecure) & analysis$subset == T 
                                          & analysis$excludecov2 == T,]), big.mark = ',', trim = T)
n_analysis <- format(nrow(analysis[analysis$subset3 == T,]), big.mark = ',', trim =T)
```

# Results  
There were `r n_tot` participants who were selected for the morning examination (fasting subsample MEC weight not equal to zero) of which `r n_incl_age` were 18-65 years old, `r n_excl_preg` were excluded for pregnancy. `r n_excl_outcome` were missing information on metabolic syndrome, `r n_excl_exp` were missing information on food security, and `r n_excl_covariates` were missing covariate information; these participants were also excluded from the analysis, giving a final n =  `r n_analysis`. (Fig `r inc(f)`) Unweighted participant characteristics and missing food security and covariate information are given in Table `r inc(t)`. 

``` {r n flowchat, fig.heigt = 4, fig.width = 8, fig.cap = "Inclusion/Exclusion Criteria"}
# create a flow chart to show inclusion/exclusion criteria
library(diagram)
par(mar = c(1,1,1,1))
openplotmat()
elpos <- coordinates(c(1,1,2,1))

elpos <- matrix(c(0.25,0.9,0.25,0.625,0.25,0.325,0.5,0.325,0.25,0.125), byrow = T, ncol = 2)
fromto <- matrix(ncol = 2, byrow = T,data = c(1, 2, 2, 3, 3, 4, 3, 5))
nr     <- nrow(fromto)
arrpos <- matrix(ncol = 2, nrow = nr)
for (i in 1:nr)
  arrpos[i,] <- straightarrow (to = elpos[fromto[i, 2], ],
                               from = elpos[fromto[i, 1], ],
                               lwd = 1, arr.pos = 0.6, arr.length = 0.2)
textrect(elpos[1,], radx = 0.2, rady = 0.1, 
         lab = c("Fasting Subsample", paste0('N = ', n_tot)), cex = 1)
textrect(elpos[2,], radx = 0.2, rady = 0.1, 
         lab = c("18-65 yr old", paste0('N = ', n_incl_age)), cex = 1)
textrect(c(0.7, 0.325), radx = 0.225, rady = 0.15, 
         lab = c("Excluded:", 
                 paste0('N = ', n_excl_preg, ' (Pregnancy)'), 
                 paste0('N = ', n_excl_outcome, ' (Missing Outcomee)'), 
                 paste0('N = ', n_excl_exp, ' (Missing Exposure)'), 
                 paste0('N = ', n_excl_covariates, ' (Missing Covariates)')), 
         cex = 0.75)
textrect(elpos[5,], radx = 0.2, rady = 0.07, lab = paste0('N = ', n_analysis), cex = 1)
```

\newpage
```{r demographics uw}
# unweighted demographics table
table1_alt <- cbind(row.names(table1_alt), table1_alt)
row.names(table1_alt) <- NULL
panderOptions('table.split.table', Inf)
panderOptions('table.split.cells', c(40, rep(4,5)))
emphasize.strong.cols(1)
set.alignment(c('left', rep('center',5)))
pander(table1_alt, 
       caption = 'Charactersitcs of Study Participants by Food Security Category')
```

\newpage
\blandscape

```{r demograpics w}
# weighted demographics table
tblweig <- cbind(row.names(table2),table2[,-3], table2alt)
row.names(tblweig) <- NULL
panderOptions('table.split.cells', c(40, rep(11,7)))
emphasize.strong.cols(1)
set.alignment(c('left', rep('center',7)))
pander(tblweig, 
       caption = 'Weighted Charactersitcs of Study Participants by Food Security Category')
```

\elandscape

\newpage
The prevalence of metabolic syndrome increased with age but has not changed over time. However the prevalence of food insecurity while decreasing with age, has been increasing in over time. (Figs `r inc(f)` & `r inc(f)`). 

```{r age-period graphs, fig.cap= "Prevalence of Metabolic Syndrome and Food Insecurity by Age and NHANES Cycle"}
# title2 <- 
#   textGrob("Prevalence of Metabolic Syndrome and Food Insecurity by Age and NHANES Cycle", 
#            gp=gpar(fontface="bold"))
grid.arrange(arrangeGrob(plotMSbyAGe + theme(legend.position="none"),
                         plotFIbyAGe + theme(legend.position="none"),
                         nrow=1, ncol = 2, bottom = 'Midpoint of Age'), 
             mylegend, ncol = 2, widths = c(6, 1), left = 'Prevalence')

```

```{r foodseccat graphs, fig.height = 7, fig.cap = "Prevalence of Food Security Categories by Age and NHANES Cycle"}
# title1=textGrob("Prevalence of Food Security Categories by Age and NHANES Cycle",
#                 gp=gpar(fontface="bold"))
grid.arrange(arrangeGrob(p_FS2 + theme(legend.position="none"),
                         p_FS3 + theme(legend.position="none"),
                         p_FS4 + theme(legend.position="none"),
                         nrow=3, ncol = 1),
              mylegend, ncol = 2, widths = c(6, 1), left = 'Prevalence')
```

\newpage



```{r results}
# function to round ratios and put CIs in parentheses
CItxt <- function(obj) {
  y <- sapply(obj, function(x) sprintf('%.2f',x))
  z <- paste0(y[1], '(', y[2], '-', y[3], ')')
  return(z)
}

# Create table of prevalence and crude relative risks

RR_basic_noalc <- CItxt(RR_basic_noalc)
RR_basic_noalc2 <- apply(RR_basic_noalc2, MARGIN = 1, CItxt)

UnadjTbl1 <- matrix(c('\\ ', prevalence_noalc, '---', prevalence_alt_noalc,
                      '\\ ', '\\ ', RR_basic_noalc, 
                      '\\ ', RR_basic_noalc2),
                     ncol = 1, 
                     dimnames = list(c('Unadjusted Prevalence',
                                       '\\ Food Secure',
                                       '\\ Food Insecure',
                                       '---',
                                       '\\ Full food security', 
                                       '\\ Marginal food security', 
                                       '\\ Low Food security', 
                                       '\\ Very low Food security',
                                       'Crude Relative Risk',
                                       'vs.  Food Secure', 
                                       '\\ Food Insecure',
                                       'vs. Full Food Security ', 
                                       '\\ Marginal Food Security', 
                                       '\\ Low Food Security', 
                                       '\\ Very Low Food security'), 
                                     c('Metabolic Syndrome')))
panderOptions('table.split.table', Inf)
set.alignment('center', row.names = 'left')
pander(UnadjTbl1, 
       caption = 'Unadjusted Prevalence and Relative Risk of Metabolic Syndrome')

# Adjusted relative risks stratified by gender
RR_male <- CItxt(RR_male)
RR_female <- CItxt(RR_female)
RR_male_noalc <- CItxt(RR_male_noalc)
RR_female_noalc <- CItxt(RR_female_noalc)
RR_male_cat_noalc <- apply(RR_male_cat_noalc, 1, CItxt)

AdjTab <- matrix(c('\\ ', '\\ ', RR_male_noalc, '\\ ', RR_male_cat_noalc,
                   '\\ ', '\\ ', RR_female_noalc, '', 
                   RR_female_cat_noalc), ncol = 2, byrow = F, 
                 dimnames = list(c('Adjusted Risk Ratio', 
                                   'vs. Food Secure', 
                                   '\\ Food Insecure', 
                                   'vs. Full Food Security ', 
                                   '\\ Marginal Food Security', 
                                   '\\ Low Food Security', 
                                   '\\ Very Low Food security'),
                                 c('Male', 'Female')))
                 
set.alignment('center', row.names = 'left')
pander(AdjTab, 
       caption = 'Adjusted Risk Ratio Metabolic Syndrome by Food Insecurity Status/Category')

```



# Discussion  
The biggest limitation of this study is the cross-sectional design. Metabolic syndrome increases over time as would be expected as poor diet and lifestyle take time to

# Conculsions  

# References


